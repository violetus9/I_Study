## JS에서의 Thread

프로세스는 메모리상 실행중인 작업을 말하며 프로세스 내의 실행 단위를 스레드라고 한다.

자바스크립트의 엔진은 하나의 콜 스택을 가지는 싱글 스레드이다. 하지만 실제 작동은 브라우저나 node.js와 같은 멀티 스레드 환경에서 이뤄지기 때문에 자바스크립트와 웹api, 이벤트 루프 등을 분리하여 말하긴 어렵다.

결과적으로 자바스크립트는 싱글 스레드로 동작하지만, 런타임 환경이 멀티 스레드를 제공하기에 멀티 스레드 프로세스 작업을 다룰 수 있다.

<br>

**JS런타임**

JS의 런타임은 다음과 같이 구성되어 있다.

- 자바스크립트 엔진

  - 메모리 힙

  - 콜 스택

- 웹 api

- 이벤트 루프

- 콜백 큐

<br>

여기서 메모리 힙은 메모리 할당이 이루어 지는 곳이며 선언한 변수와 함수가 들어가게 된다.

콜 스택은 코드들이 실제로 실행되는 곳이며 순차적으로 실행하게 된다.  
만일 할당된 공간을 넘기게 되는 경우 스택 오버플로우 에러가 발생.

<br>

**비동기 함수 실행 과정**

1. 콜 스택에서 비동기 함수가 실행되면 JS엔진은 브라우저에서 제공되는 웹 api에 작업을 위임한다.

2. 웹 api는 해당 비동기 작업을 수행한 후, 콜백 함수를 이벤트 루프를 통해 콜백 큐로 넘긴다.

3. 이벤트 루프는 콜 스택이 비어있을 때, 콜백 큐의 콜백 함수를 콜 스택으로 넘긴다.

4. 콜백 함수가 실행되며 콜 스택에서 제거된다.

<br>

싱글 스레드 언어임에도 블로킹이 일어나지 않고 여러 일을 동시에 처리하는 것처럼 동작하는데 이것을 concurrency라 부른다.

그 덕에 자바스크립트는 싱글 스레드 기반의 스크립트 언어임에도 비동기적 처리를 지원하기에 빠른 동작을 할 수 있는 것.
