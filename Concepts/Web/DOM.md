## DOM

Document Object Model.

웹 페이지에 대한 인터페이스(window, document 요런 객체들)다. 여러 프로그램들이 웹 페이지의 컨텐츠 및 구조, 스타일을 읽고 조작할 수 있도록 API를 제공한다.

웹 페이지는 문서(document)라고 할 수 있는데 DOM은 구조화된 노드와 속성들, 메서드를 갖고 있는 객체로 문서를 표현한다. 이 객체들은 웹 페이지를 스크립트나 프로그래밍 언어들에서 사용될 수 있도록 연결짓는 역할을 한다.

즉, DOM은 웹 페이지의 객체 지향적 표현이라고 할 수 있다. 동일한 문서를 표현하고 저장, 조작하는 방법을 제공한다.  
스크립트 언어를 이용해 DOM을 수정할 수 있다.

<br>

### 웹 페이지 빌드 과정

웹 브라우저가 원본 HTML 문서를 읽은 후 스타일을 입히며 대화형 페이지를 생성해 뷰 포트에 표시하기 까지의 과정을 Critical Rendering Path라고 말한다.

이 과정은 여러 단계로 나누어저 있지만 두 단계로 크게 나눠볼 수 있다.

첫 번째 과정은 브라우저가 읽은 문서를 파싱하고 어떤 내용을 페이지에 렌더링할 것인지 결정하는 단계이며 두 번째 단계는 브라우저가 렌더링을 수행한다.

첫 번째 과정을 거치면 `렌더 트리`라는 것이 생성된다. 이 트리는 페이지에 표시 될 HTML 요소들과 관련된 스타일 요소로 구성되는데, 렌더 트리를 생성하기 위해선 다음 두 모델이 필요하다.

- DOM - HTML 요소들의 구조화된 표현
- CSSOM - 요소들과 관련된 스타일 정보들의 구조화된 표현

<br>

### 그렇다면 DOM은 어떻게 생성되며 보여질까

DOM은 원본 HTML 문서의 객체 기반 표현 방식이다. 그리고 DOM의 구조는 노드 트리로 표현되는데, 이 경우 루트 노드는 html이 되며 해당 루트에 여러 자식 태그들을 노드로 담으며 트리 구조를 완성시킨다.

```html
<html>
	<head>
		<title>TITLE</title>
	</head>
	<body>
		<h1>OH</h1>
		<p>OHHHH~~</p>
	</body>
</html>
>
```

위와 같은 구조는 트리로 표현하자면 대강 이런식이다.  
['html', 'head', 'title', 'TITLE', 'body', 'h1', 'OH', 'P', 'OHHHH~~']

<br>

### DOM이 아닌 것

위 예제까지만 보면 DOM은 HTML 문서와 1대 1 매칭이 되는 것 처럼 보이지만 실제론 몇가지 차이가 있다.

<br>

1. DOM !== HTML

   DOM은 HTML 문서로부터 나오는 것은 맞다. 하지만 그 둘이 동일하다는 이야기는 아니다.

   **작성된 HTML 문서가 유효하지 않은 경우**

   DOM을 생성하는 동안, 브라우저는 유효하지 않은 HTML 코드를 바르게 교정한다.

   HTML 요소의 필수인 head와 body 요소를 빠뜨리고 HTML 태그를 구성했다고 하면, DOM 트리에는 올바르게 요소가 포함된 상태로 교정되어 나타난다.

    <br>

   **JS에 의해 DOM이 수정되는 경우**

   DOM은 HTML 문서의 동적 자원이 되어 수정될 수 있다. JS의 `createElement`를 통해 요소를 추가하는 경우가 그렇다.

   해당 코드는 DOM을 업데이트 할 것이다. 하지만 HTML 문서의 내용을 변경하진 않는다.

<br>

2. DOM은 브라우저에서 보이지 않는다.

   브라우저 뷰 포트에 보이는 것은 렌더 트리이며 이 트리는 DOM과 CSSOM의 조합이라고 했다. 렌더 트리는 오로지 스크린에 그려지는 것으로 구성되어 있기 때문에 DOM과는 다르다.

   즉, 렌더링 될 요소만이 관련되어 있기 때문에 시각적으로 보이지 않는 `display: none`의 경우가 그렇다.

   만일 `p`태그에 해당 스타일 속성이 들어있다고 해보자.

   DOM 트리는 `p`태그를 트리 요소에 포함한다. 그리고 렌더 트리에 해당하는 뷰 포트에 표시될 내용은 `p`태그를 요소로 포함하지 않는다.

<br>

3. DOM은 개발 도구에서 보이는 것이 아니다.

   개발 도수의 요소 탭은 DOM에 없는 추가 정보를 포함하게 된다.

   가령 CSS의 가상요소 `::before`, `::after` 선택자들을 통해 생성될 가상 요소는 CSSOM과 렌더 트리의 일부를 구성하지만, 기술적으로 DOM의 일부라고 할 수는 없다.

   DOM은 오로지 원본 HTML 문서로 빌드되며 요소에 적용되는 스타일을 포함하지 않기 때문이다.

   이러한 이유로 가상 요소는 DOM의 일부가 아니기에 JS로 인한 수정이 불가능 한 것이다.

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

참고

- https://d2.naver.com/helloworld/59361

- https://developer.mozilla.org/ko/docs/Web/API/Document_Object_Model/Introduction
