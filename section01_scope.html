<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>scope</title>
</head>

<body>

  <script>
    // var
    // ES6 이전은 func 단위의 스코프만 존재했다
    // 그렇지않다면 체이닝, 추적 (스코프 체인)
    var name = 'global var';

    function home() {
      var homevar = 'homevar';
      for (var i = 0; i < 100; i++) {
      }
      console.log(i);
    }
    home();

  </script>

  <ul>
    <li>javascript</li>
    <li>java</li>
    <li>python</li>
    <li>django</li>
  </ul>

  <script>
    // 새로운 키워드 let, 블럭단위의 스코프가 지원이 됨
    // + 클로저스코프에 대해 보자

    // // 문제 발생 코드
    // var list = document.querySelectorAll('li');
    // for(var i=0;i<list.length;i++){
    //   list[i].addEventListener('click', function(){
    //     console.log(i+'번째 리스트');
    //   });
    // }

    // 해당 리스트 찍어보면 4번째 리스트라는 글만 출력된다 >> 클로저문제
    // 콜백이 가진 i값은 밖의 변수를 계속 참조하여 func은 값을 기억한다.
    // i값은 클로저 변수라고 할 수 있다, 이벤트리스너 4개 생성이되며 밖의 i값을 공유하기에 클로저 문제 발생
    // 함수 내부 지역변수를 생성시켜 해결할 수 있으나, let을 사용하면 간단히 해결된다 

    // 해결
    var list = document.querySelectorAll('li');
    for (let i = 0; i < list.length; i++) {
      list[i].addEventListener('click', function () {
        console.log(i + '번째 리스트');
      });
    }

  </script>

  <script>
    // const
    function home1() {
      var homename = 'myhouse';
      homename = 'yrhouse';
    }
    home();
    // 변경을 원치 않는경우 대문자로 변수명을 지정해서(표준적인 방법은 아니라 함) 할 수 있지만
    // var 대신 const를 넣는다면 불변의 변수, 문자열 아닌 배열도 가능하다.
    // 즉, var 사용은 ES6에서는 지양토록 하자

  </script>

  <script>
    // const 특성과 immutable array
    function home2() {
      const list1 = ['apple', 'orange', 'good'];
      // list1 = 'occured error';
      list1.push('banana');
      console.log(list1);
    }
    // const 사용한 경우 변수에 재할당한다면 오류가 발생, 반면 .push와 같은 함수는 적용 가능함

    // 참고
    // immutable array를 어떻게 만들까?
    // 예를들면 뒤로가기, 앞으로가기로 값을 되돌리고 싶을 때
    const list2 = ['apple', 'orange', 'banana'];
    list3 = [].concat(list, 'bababa');
    console.log(list2 === list3); // false

  </script>

</body>



</html>